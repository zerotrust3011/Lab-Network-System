Dist1

ena
conf t
vlan 10
vlan 20
exit
interface Port-channel1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/0
 no switchport
 ip address 10.10.50.2 255.255.255.252
 exit
interface Ethernet0/1
 no switchport
 ip address 10.10.90.2 255.255.255.252
 exit
interface Ethernet0/2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/3
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet1/2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 channel-group 1 mode active
 exit
interface Ethernet1/3
 switchport trunk encapsulation dot1q
 switchport mode trunk
 channel-group 1 mode active
 exit
interface Vlan10
 ip address 192.168.10.2 255.255.255.0
 standby 10 ip 192.168.10.1
 standby 10 priority 150
 standby 10 preempt
 exit
interface Vlan20
 ip address 192.168.20.2 255.255.255.0
 standby 20 ip 192.168.20.1
 standby 20 priority 150
 standby 20 preempt
 exit
router ospf 10
 router-id 11.11.11.11
 passive-interface Ethernet0/2
 passive-interface Ethernet0/3
 network 10.10.50.0 0.0.0.3 area 10
 network 10.10.60.0 0.0.0.3 area 10
 network 10.10.70.0 0.0.0.3 area 10
 network 10.10.90.0 0.0.0.3 area 10
 network 192.168.10.0 0.0.0.255 area 10
 network 192.168.20.0 0.0.0.255 area 10
 exit

Dist2

vlan 10
vlan 20
exit
ena
conf t
interface Port-channel2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/0
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/1
 no switchport
 ip address 10.10.90.1 255.255.255.252
 exit
interface Ethernet0/2
 no switchport
 ip address 10.10.60.1 255.255.255.252
 exit
interface Ethernet0/3
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet1/2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 channel-group 2 mode active
 exit
interface Ethernet1/3
 switchport trunk encapsulation dot1q
 switchport mode trunk
 channel-group 2 mode active
 exit
interface Vlan10
 ip address 192.168.10.3 255.255.255.0
 standby 10 ip 192.168.10.1  <-- IP Gateway ảo
 standby 10 priority 160    <-- Ưu tiên cao hơn để làm Active
 standby 10 preempt        <-- Cho phép chiếm quyền
 exit
interface Vlan20
 ip address 192.168.20.3 255.255.255.0
 standby 20 ip 192.168.20.1
 standby 20 priority 160
 standby 20 preempt
 exit
router ospf 10
 router-id 22.22.22.22
 network 10.10.50.0 0.0.0.3 area 10
 network 10.10.60.0 0.0.0.3 area 10
 network 10.10.70.0 0.0.0.3 area 10
 network 10.10.90.0 0.0.0.3 area 10
 network 192.168.10.0 0.0.0.255 area 10
 network 192.168.20.0 0.0.0.255 area 10
 exit

Dist3

vlan 30
vlan 40
exit
ena
conf t
hostname Dist3
int ran e1/2,e1/3
 channel-gr 1 mode active
 ex
interface Port-channel1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/0
 no switchport
 ip address 10.10.70.2 255.255.255.252
 no shut
 exit
interface Ethernet0/1
 no switchport
 ip address 10.10.100.2 255.255.255.252
 no shut
 exit
interface Ethernet0/2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/3
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Vlan30
 ip address 192.168.30.2 255.255.255.0
 no shut
 standby 30 ip 192.168.30.1
 standby 30 priority 150
 standby 30 preempt
 exit
interface Vlan40
 ip address 192.168.40.2 255.255.255.0
 no shut
 standby 40 ip 192.168.40.1
 standby 40 priority 150
 standby 40 preempt
 exit
router ospf 10
 router-id 33.33.33.33
 passive-interface Ethernet0/2
 passive-interface Ethernet0/3
 network 10.10.70.0 0.0.0.3 area 10
 network 10.10.100.0 0.0.0.3 area 10
 network 192.168.30.0 0.0.0.255 area 10
 network 192.168.40.0 0.0.0.255 area 10
 exit

Dist4

vlan 30
vlan 40
exit
ena
conf t
hostname Dist4
int ran e1/2,e1/3
 channel-gr 1 mode active
 ex
interface Port-channel1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/0
 no switchport
 ip address 10.10.80.1 255.255.255.252
 no shut
 exit
interface Ethernet0/1
 no switchport
 ip address 10.10.100.1 255.255.255.252
 no shut
 exit
interface Ethernet0/2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/3
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Vlan30
 ip address 192.168.30.3 255.255.255.0
 no shut
 standby 30 ip 192.168.30.1
 standby 30 priority 160
 standby 30 preemp
 exit
interface Vlan40
 ip address 192.168.40.3 255.255.255.0
 no shut
 standby 40 ip 192.168.40.1
 standby 40 priority 160
 standby 40 preempt
 exit
router ospf 10
 router-id 44.44.44.44
 passive-interface Ethernet0/2
 passive-interface Ethernet0/3
 network 10.10.80.0 0.0.0.3 area 10
 network 10.10.100.0 0.0.0.3 area 10
 network 192.168.30.0 0.0.0.255 area 10
 network 192.168.40.0 0.0.0.255 area 10
 exit

Access1

ena
conf t
vlan 10
vlan 20
exit
interface Ethernet0/0
 switchport trunk allowed vlan 10,20,30,40,50,60
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/1
 switchport trunk allowed vlan 10,20,30,40,50,60
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/2
 switchport access vlan 10
 switchport mode access
 exit
interface Ethernet0/3
 switchport access vlan 20
 switchport mode access
 exit

Access2
ena	
conf t
vlan 10
vlan 20
exit
interface Ethernet0/0
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/2
 switchport access vlan 20
 switchport mode access
 exit
interface Ethernet0/3
 switchport access vlan 20
 switchport mode access
 exit

Access3

ena	
conf t
hostname Access3
vlan 30
vlan 40
exit
interface Ethernet0/0
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/2
 switchport access vlan 30
 switchport mode access
 exit

Access4

ena	
conf t
hostname Access4
vlan 30
vlan 40
exit
interface Ethernet0/0
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 exit
interface Ethernet0/2
 switchport access vlan 40
 switchport mode access
 exit
do wr

Core 1

ena
conf t
hostname Core1
interface Ethernet0/0
 no switchport
 ip address 10.10.40.1 255.255.255.252
 exit
interface Ethernet0/1
 no switchport
 ip address 10.10.50.1 255.255.255.252
 exit
interface Ethernet0/2
 no switchport
 ip address 10.10.20.2 255.255.255.252
 exit
interface Ethernet0/3
 no switchport
 ip address 10.10.70.1 255.255.255.252
router ospf 10
 router-id 1.1.1.1
 passive-interface default
 no passive-interface Ethernet0/0
 no passive-interface Ethernet0/1
 no passive-interface Ethernet0/2
 no passive-interface Ethernet0/3
 network 10.10.20.0 0.0.0.3 area 0
 network 10.10.40.0 0.0.0.3 area 0
 network 10.10.50.0 0.0.0.3 area 10
 network 10.10.60.0 0.0.0.3 area 10
 network 10.10.70.0 0.0.0.3 area 10
 network 10.10.80.0 0.0.0.3 area 10
 exit

Core 2

ena
conf t
hostname Core2
interface Ethernet0/0
 no switchport
 ip address 10.10.40.2 255.255.255.252
 exit
interface Ethernet0/1
 no switchport
 ip address 10.10.60.2 255.255.255.252
 exit
interface Ethernet0/2
 no switchport
 ip address 10.10.80.2 255.255.255.252
 exit
interface Ethernet0/3
 no switchport
 ip address 10.10.30.2 255.255.255.252
 exit
router ospf 10
 router-id 2.2.2.2
 passive-interface default
 no passive-interface Ethernet0/0
 no passive-interface Ethernet0/1
 no passive-interface Ethernet0/2
 no passive-interface Ethernet0/3
 network 10.10.30.0 0.0.0.3 area 0
 network 10.10.40.0 0.0.0.3 area 0
 network 10.10.50.0 0.0.0.3 area 10
 network 10.10.60.0 0.0.0.3 area 10
 network 10.10.70.0 0.0.0.3 area 10
 network 10.10.80.0 0.0.0.3 area 10
 exit

R20

ena
conf t
host R20
interface Ethernet0/0
 no shut
 ip address 10.10.20.1 255.255.255.252
 exit
interface Ethernet0/1
 no shut
 ip address 10.10.10.1 255.255.255.252
 exit
interface Ethernet0/2
 no shut
 ip address 10.10.30.1 255.255.255.252
 exit
router ospf 1
 router-id 20.20.20.20
 network 10.10.20.0 0.0.0.3 area 0
 network 10.10.30.0 0.0.0.3 area 0
 default-information originate
ip route 0.0.0.0 0.0.0.0 10.10.10.2
do wr

R14

ena
conf t
hostname R14
interface Loopback1
 no shut
 ip address 4.4.4.4 255.255.255.255
 exit
interface Ethernet0/0
 no shut
 ip address 203.65.50.2 255.255.255.252
 ip nat outside
 exit
interface Ethernet0/1
 no shut
 ip address 200.200.200.2 255.255.255.252
 ip nat inside
 exit
do wr

R24

ena
conf t
hostname R24
interface Ethernet0/0
 no shut
 ip address 203.65.50.1 255.255.255.252
 ip nat outside
 exit
interface Ethernet0/1
 no shut
 description CoSo1
 ip address 172.16.10.1 255.255.255.0
 ip nat inside
 exit 
ip access-list extended NAT
 permit ip 172.16.10.0 0.0.0.255 any
 deny   ip any any
 exit
ip nat inside source list NAT interface Ethernet0/0 overload
ip route 0.0.0.0 0.0.0.0 203.65.50.2
do wr

R9

ena
conf t
hostname R9
interface Ethernet0/0
 ip address 10.10.11.2 255.255.255.252
 ip nat inside
 exit
interface Ethernet0/1
 ip address 200.200.200.1 255.255.255.252
 ip nat outside
 exit
ip access-list extended NAT
 permit ip any any
 exit
ip nat inside source list NAT interface Ethernet0/1 overload
ip route 0.0.0.0 0.0.0.0 200.200.200.2
do wr

Firewall Fortigate   (user:admin - pass: admin)

config system interface
 edit port1
 set mode static
 set ip 192.168.10.50/24
 set allowaccess https http ssh ping
 end
 



